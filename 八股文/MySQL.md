# 1. 说说MySQL的架构
包含Server层和存储引擎层

# 2. 一条SQL语句再MySQL中的执行过程
1. 先经过连接器（管理链接，权限验证）
2. 若命中缓存直接返回
3. 分析器（语义分析）
4. 优化器（执行计划生产，索引选择）
5. 执行器（操作引擎返回结果）

# 3. MySQL存储引擎架构了解吗
MySQL存储引擎采用插件式架构，存储引擎基于表，而不是数据库

# 4. MyISAM和InnoDB的区别
1. MyISAM只有表锁，InnoDB支持行锁
2. InnoDB支持事务
3. InnoDB支持外键
4. InnoDB支持数据库异常崩溃后的安全回复（redo log）
5. InnoDB支持MVCC
6. 索引实现不一样：InnoDB 引擎中，其数据文件本身就是索引文件。相比 MyISAM，索引文件和数据文件是分离的

# 5. 什么是事务
逻辑上的一组操作，要么都执行要么都不执行

# 6. 事务四大特性
A：Atomicity：原子性：事务是最小的执行单位，要么都执行要么都不执行
C：Consistency：一致性：执行事务前后，数据保持一致
I：Isolation：隔离性：并发访问数据库时，各并发事务之间的数据库是独立的
D：Durability：持久性：事务提交后，它对数据库的改变是持久的

AID是手段，C是目的

# 7. 并发事务带来哪些问题
- 脏读
![输入图片说明](/imgs/2025-03-25/tWf2KgMQtOVcLbjw.png)
- 丢失更改
![输入图片说明](/imgs/2025-03-25/WPKYCyKRzOoGTiqE.png)
- 不可重复读
![输入图片说明](/imgs/2025-03-25/SrcPiadr8gZ3YSUO.png)
- 幻读
![输入图片说明](/imgs/2025-03-25/yNsL8VG4EP0Zh4wp.png)

# 8. SQL定义了哪些事务隔离级别
从低到高
- 读取未提交
- 读取已提交（可阻止脏读）
- 可重复读（可阻止脏读和不可重复读）（默认）
- 可串行化：全部组织，所有的事务依次逐个执行，不互相干扰

# 9. MVCC
MVCC是一种并发版本控制机制，通过在每个数据行上维护多个版本的数据实现，当一个事务要修改数据库中数据时，MVCC 会为该事务创建一个数据快照，而不是直接修改实际的数据行。

# 10. InnoDB有哪几类行锁
- 记录锁：单个行记录上的锁
- 间隙锁：锁定一个范围不包括记录本身
- 临键锁：锁定一个范围包括记录本身，解决幻读问题（避免插入新纪录）

# 11. 意向锁有什么作用
快速判断能否对某个表使用表锁

# 12. 索引的底层实现
B+树，只有叶子节点存放key和data，其他内节点只存放key，叶子节点有一条引用链指向相邻的叶子节点

# 13. 主键索引和二级索引
- 主键索引：主键列使用的
- 二级索引（辅助索引）：叶子节点存储的数据是主键

# 14. 聚集索引和非聚集索引
-   聚簇索引（聚集索引）：索引结构和数据一起存放的索引，InnoDB 中的主键索引就属于聚簇索引。
-   非聚簇索引（非聚集索引）：索引结构和数据分开存放的索引，二级索引（辅助索引）就属于非聚簇索引。

# 15. 覆盖索引
需要查询的字段正好是索引的字段，直接根据索引可以查到数据，无需回表查询

# 16. 联合索引
使用表中的多个字段创建索引

# 17. 最左前缀匹配原则
在使用联合索引时，MySQL 会根据索引中的字段顺序，从左到右依次匹配查询条件中的字段。如果查询条件与索引中的最左侧字段相匹配，那么 MySQL 就会使用索引来过滤数据，这样可以提高查询效率。
最左匹配原则会一直向右匹配，直到遇到范围查询（如 >、<）为止。对于 >=、<=、BETWEEN 以及前缀匹配 LIKE 的范围查询，不会停止匹配

# 18. 索引下推
存储引擎在索引遍历过程中，执行部分 `WHERE` 字句的判断条件，直接过滤掉不满足条件的记录，从而减少回表次数，提高查询效率。

# 19. 如何更好地建立索引
1. 选择合适的字段作为索引（不为null，频繁查询，where条件...)
2. 尽可能建立联合索引而不是单列索引
3. 字符串类型使用前缀索引
4. 索引失效（select*，查询条件不遵守最左匹配，在索引上计算，以%开头的模糊查询）

# 20. 慢查询日志
记录执行时间超过`long_query_time`的所有查询

# 21. binlog
binlog是逻辑日志，记录语句的原始逻辑，记录了数据库中的所有变化

# 22. redo log
InnoDB独有，让MySQL拥有
<!--stackedit_data:
eyJoaXN0b3J5IjpbNDU4Nzk4NDQzXX0=
-->