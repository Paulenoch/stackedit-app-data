# 共同关注
在数据库中用Set存储每个用户所有的关注对象，key是当前用户id，value是所有关注对象的id，查询两个用户的共同关注可以取两个Set的交集

# 关注推送（Feed流）

### 拉模式（读扩散）
用户发送笔记时将笔记存入发件箱，当用户读自己的收件箱时将自己关注的所有用户的发件箱的内容拉取到自己的收件箱中，读完后可以清理收件箱。
- 优点：省内存
- 缺点：延迟（一个用户关注了大量的用户）
![输入图片说明](/imgs/2025-04-15/5AQMkiBCmr1VhTMD.png)

### 推模式（写扩散）
不存在发件箱，用户发笔记的时候，直接将笔记推送到所有关注该用户的收件箱中
缺点：耗内存
![输入图片说明](/imgs/2025-04-15/XyQsmDd7pRLU90D1.png)


<!--stackedit_data:
eyJoaXN0b3J5IjpbLTE4OTE1Nzg5NDQsLTE4NzQ1MTY2NTUsLT
c4NzIyNzkwOF19
-->